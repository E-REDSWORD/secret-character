<!DOCTYPE html><html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>لعبة الشخصية السرية</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #222; color: #fff; text-align: center; direction: rtl; padding: 20px; }
    h1 { color: #ffcc00; }
    input, button, select { padding: 10px; margin: 5px; font-size: 1em; border-radius: 5px; border: none; }
    button { background: #007acc; color: #fff; cursor: pointer; }
    button:hover { background: #005fa3; }
    #hints { margin-top: 20px; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto; }
    #hints li { background: #333; padding: 10px; margin: 5px 0; border-radius: 5px; }
    #scoreBoard { margin-top: 30px; }
    #scoreBoard table { width: 100%; max-width: 400px; margin: auto; border-collapse: collapse; }
    #scoreBoard th, #scoreBoard td { border: 1px solid #555; padding: 8px; }
    #scoreBoard th { background: #007acc; }
    #timer { margin-top: 20px; font-size: 1.2em; }
  </style>
</head>
<body>
	<div class="developer">
    <h2>𖤍 | 𝐑𝐄𝐃𝐒𝐖𝐎𝐑𝐃 & فريق تطوير 𝐒𝐒𝐎</h2>
    <ul>
      <li><strong>𖤍 | 𝐑𝐄𝐃𝐒𝐖𝐎𝐑𝐃</strong> –  قائد المشروع_برمجة </li>
    </ul>
  </div>
  <h1>لعبة الشخصية السرية</h1>
  <div id="setup">
    <label>عدد الفرق: <input type="number" id="teamCount" value="2" min="2" max="8"></label>
    <button onclick="createTeams()">تأكيد</button>
    <div id="teamInputs"></div>
  </div>
  <div id="gameArea" style="display:none;">
    <button onclick="newCharacter()">شخصية جديدة</button>
    <div id="characterName" style="margin-top:20px; font-size:1.2em; color:#0f0;"></div>
    <ul id="hints"></ul>
    <div>
      <label for="winnerSelect">الفريق الفائز:</label>
      <select id="winnerSelect"></select>
      <button onclick="awardPoints()">احتساب النقاط</button>
      <button onclick="penaltyAll()">لا أحد - خصم نقطة</button>
      <button onclick="nextRound()" id="nextBtn" style="display:none;">التالي</button>
    </div>
    <div id="timer">
      مدة الجولة: <input type="number" id="timerInput" value="30" min="5" max="300"> ثانية
      <button onclick="startTimer()">ابدأ المؤقت</button>
      <div id="timerDisplay"></div>
    </div>
    <div id="scoreBoard">
      <h3>النقاط</h3>
      <table>
        <thead><tr><th>الفريق</th><th>النقاط</th></tr></thead>
        <tbody id="scoreRows"></tbody>
      </table>
    </div>
  </div><script>
  let teams = [], scores = [], currentCharacter = null, hintsDB = [];
  // جلب قاعدة البيانات من ملف خارجي
  fetch('character_hints_100.json')
    .then(res => res.json())
    .then(data => hintsDB = data);

  function createTeams() {
    const count = +document.getElementById('teamCount').value;
    const container = document.getElementById('teamInputs');
    container.innerHTML = '';
    teams = [];
    for (let i=0; i<count; i++) {
      const inp = document.createElement('input'); inp.placeholder = 'اسم الفريق '+(i+1);
      container.appendChild(inp);
    }
    const btn = document.createElement('button'); btn.textContent='ابدأ اللعبة'; btn.onclick = startGame;
    container.appendChild(btn);
  }

  function startGame() {
    const inputs = document.querySelectorAll('#teamInputs input');
    teams = Array.from(inputs).map(i=>i.value.trim()).filter(v=>v);
    if (teams.length<2) return alert('أدخل أسماء فريقين على الأقل');
    scores = teams.map(_=>0);
    // تهيئة قائمة اختيار الفائز
    const sel = document.getElementById('winnerSelect'); sel.innerHTML = teams.map(t=>`<option>${t}</option>`).join('');
    document.getElementById('setup').style.display='none';
    document.getElementById('gameArea').style.display='block';
    newCharacter();
    renderScores();
  }

  function newCharacter() {
    document.getElementById('nextBtn').style.display='none';
    const idx = Math.floor(Math.random()*hintsDB.length);
    currentCharacter = hintsDB[idx];
    document.getElementById('characterName').textContent = currentCharacter.character;
    const hintsList = document.getElementById('hints'); hintsList.innerHTML='';
    currentCharacter.hints.slice(0,10).forEach(h=>{
      const li = document.createElement('li'); li.textContent=h; hintsList.appendChild(li);
    });
  }

  function awardPoints() {
    const winner = document.getElementById('winnerSelect').value;
    const i = teams.indexOf(winner);
    if (i>=0) scores[i]+=3;
    renderScores();
    document.getElementById('nextBtn').style.display='inline-block';
  }
  function penaltyAll() {
    scores = scores.map(s=>s-1);
    renderScores();
    document.getElementById('nextBtn').style.display='inline-block';
  }
  function nextRound() {
    newCharacter();
  }

  function renderScores() {
    const rows = document.getElementById('scoreRows');
    rows.innerHTML = teams.map((t,i)=>`<tr><td>${t}</td><td>${scores[i]}</td></tr>`).join('');
  }

  let timerId;
  function startTimer() {
    clearInterval(timerId);
    let time = +document.getElementById('timerInput').value;
    const disp = document.getElementById('timerDisplay'); disp.textContent = time+'s';
    timerId = setInterval(()=>{
      time--; disp.textContent = time+'s';
      if(time<=0) clearInterval(timerId);
    },1000);
  }
</script></body>
</html>